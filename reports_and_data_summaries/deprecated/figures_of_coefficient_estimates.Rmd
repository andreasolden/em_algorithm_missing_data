---
title: "Plotting coefficients"
author: "Andreas Olden"
date: "January 24, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

options(encoding="UTF-8")
```

```{r libraries, include=FALSE}

#Initiate project
library(checkpoint) #Checkpoint assures us that we use the same package versions
checkpoint("2019-01-21") #As they were at the date set in this function. i.e "2019-01-21"
library(here) # allows us to use relative file paths, see readme or simulations doc
library(tidyverse) # Tidyverse data wrangling tool to use pipe-operator
library(knitr)
```

This is a Mardown document, cheat sheet: <https://www.rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf>
Figures using ggplot2, cheat sheet: <https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf>

##Create figures

### One variable case

####Sim 1: One variable, alfa(-1.8,-1.5), beta(-0.02), xval(0), xsd(12.3)

```{r, echo=FALSE, message=FALSE}

        readRDS( here("results", "dfs1.rds") ) %>%
        select(EMb, BIb) %>%
        gather(coefficient, estimate, factor_key = TRUE) %>%
        ggplot(., aes(x=estimate, linetype=coefficient)) + 
                geom_freqpoly()  +
                geom_vline(data =  readRDS( here("results", "dfs1.rds") ), 
                           aes(xintercept = mean(tb)) )

```

### Two variable case

####Sim 4: alfa(-1.8,-1.5), beta(-0.02, 0.2), xval(0), xsd(12.3, 1.8), corr(0)

```{r, echo=FALSE, message=FALSE}
#Add true value under vl, update file
trueval <- data.frame(coeff_type = c("b1", "b2"), vl = c(-0.02, 0.2))

 readRDS( here("results", "dfs4.rds") ) %>%
        select(EMb1, EMb2, BIb1, BIb2) %>%
        gather(coefficient, estimate, factor_key = TRUE) %>%
        mutate(
                est_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="EMb2"), 'EM', 'BI')),
                coeff_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="BIb1"), 'b1', 'b2'))
                )    %>%    
        ggplot(aes(x=estimate, linetype=est_type)) + 
                        geom_freqpoly() +
                facet_grid(cols = vars(coeff_type), scales = "free_x") +
                geom_vline(aes(xintercept=vl), data=trueval)
```


####Sim 5: alfa(-1.8,-1.5), beta(-0.02, 0.2), xval(0), xsd(12.3, 1.8), corr(0.5)
Add correlation

```{r, echo=FALSE, message=FALSE}
#Add true value under vl, update file
trueval <- data.frame(coeff_type = c("b1", "b2"), vl = c(-0.02, 0.2))

 readRDS( here("results", "dfs5.rds") ) %>%
        select(EMb1, EMb2, BIb1, BIb2) %>%
        gather(coefficient, estimate, factor_key = TRUE) %>%
        mutate(
                est_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="EMb2"), 'EM', 'BI')),
                coeff_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="BIb1"), 'b1', 'b2'))
                )    %>%    
        ggplot(aes(x=estimate, linetype=est_type)) + 
                        geom_freqpoly() +
                facet_grid(cols = vars(coeff_type), scales = "free_x") +
                geom_vline(aes(xintercept=vl), data=trueval)
```

####Sim 6: alfa(-1.8,-1.5), beta(-0.02, 0.2), xval(0), xsd(12.3, 1.8), corr(0.9)
Add even more correlation

```{r, echo=FALSE, message=FALSE}
#Add true value under vl, update file
trueval <- data.frame(coeff_type = c("b1", "b2"), vl = c(-0.02, 0.2))

 readRDS( here("results", "dfs6.rds") ) %>%
        select(EMb1, EMb2, BIb1, BIb2) %>%
        gather(coefficient, estimate, factor_key = TRUE) %>%
        mutate(
                est_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="EMb2"), 'EM', 'BI')),
                coeff_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="BIb1"), 'b1', 'b2'))
                )    %>%    
        ggplot(aes(x=estimate, linetype=est_type)) + 
                        geom_freqpoly() +
                facet_grid(cols = vars(coeff_type), scales = "free_x") +
                geom_vline(aes(xintercept=vl), data=trueval)
```

####Sim 8: alfa(-1.8,-1.5), beta(-0.02, 0.2), xval(0), xsd(123, 18), corr(0.0)
Increase standard deviations by 10

```{r, echo=FALSE, message=FALSE}
#Add true value under vl, update file
trueval <- data.frame(coeff_type = c("b1", "b2"), vl = c(-0.02, 0.2))

 readRDS( here("results", "dfs8.rds") ) %>%
        select(EMb1, EMb2, BIb1, BIb2) %>%
        gather(coefficient, estimate, factor_key = TRUE) %>%
        mutate(
                est_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="EMb2"), 'EM', 'BI')),
                coeff_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="BIb1"), 'b1', 'b2'))
                )    %>%    
        ggplot(aes(x=estimate, linetype=est_type)) + 
                        geom_freqpoly() +
                facet_grid(cols = vars(coeff_type), scales = "free_x") +
                geom_vline(aes(xintercept=vl), data=trueval)
```

####Sim 9: alfa(-1.8,-1.5), beta(-0.02, 0.2), xval(0), xsd(123, 18), corr(0.9)
Increase standard deviations by 10 and correlation to 0.9

```{r, echo=FALSE, message=FALSE}
#Add true value under vl, update file
trueval <- data.frame(coeff_type = c("b1", "b2"), vl = c(-0.02, 0.2))

 readRDS( here("results", "dfs9.rds") ) %>%
        select(EMb1, EMb2, BIb1, BIb2) %>%
        gather(coefficient, estimate, factor_key = TRUE) %>%
        mutate(
                est_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="EMb2"), 'EM', 'BI')),
                coeff_type = as.factor(ifelse(
                        (coefficient=="EMb1" | coefficient=="BIb1"), 'b1', 'b2'))
                )    %>%    
        ggplot(aes(x=estimate, linetype=est_type)) + 
                        geom_freqpoly() +
                facet_grid(cols = vars(coeff_type), scales = "free_x") +
                geom_vline(aes(xintercept=vl), data=trueval)
```